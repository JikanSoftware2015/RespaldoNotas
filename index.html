<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Recuperación y Respaldo de Notas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.6; background: #f5f5f5; color: #333; margin: 20px; }
    h1, h2, h3 { text-align: center; }
    .section { background: #fff; padding: 20px; margin: 20px auto; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); max-width: 900px; }
    p, li { font-size: 18px; }
    .btn { display: inline-block; padding: 12px 20px; margin: 15px 0; background: #007BFF; color: #fff; border-radius: 8px; text-decoration: none; cursor: pointer; }
    .btn:hover { background: #0056b3; }
    #video-container { display: none; margin-top: 20px; position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 12px; }
    #video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; border-radius: 12px; }
    input, textarea { width: 100%; padding: 14px; margin: 8px 0 18px; font-size: 18px; border-radius: 6px; border: 1px solid #ccc; }
    button { display: block; width: 100%; margin: 12px 0; padding: 14px; font-size: 18px; border: none; background: #0066cc; color: #fff; border-radius: 8px; cursor: pointer; }
    button:hover { background: #004999; }
    .nota { border: 1px solid #ddd; padding: 20px; margin-bottom: 20px; background: #fff; border-radius: 10px; }

    /* Mejoras responsivas */
    @media (max-width: 600px) {
      body { margin: 10px; }
      p, li { font-size: 16px; }
      input, textarea, button { font-size: 16px; padding: 12px; }
      h1 { font-size: 24px; }
      h2 { font-size: 20px; }
      h3 { font-size: 18px; }
    }
  </style>
</head>
<body>

  <p style="text-align:center; margin-bottom:20px;">
    <a href="respaldarNotasSQLite_en.html" class="btn">View English version</a>
  </p>

  <h1>Recuperación de Notas</h1>

  <div class="section">
    <h2>Explicación</h2>
    <p>Hubo robo de código, un supuesto amigo me traicionó, me robó dinero y el código. Me perjudicó y nos perjudicó a todos. En las bases de datos sin el código no se puede hacer una migración, por eso hice un formulario para que guardaran sus notas. Dejé las instrucciones en el menú pero algunos usuarios no lo leyeron. Todos me culpan porque es muy fácil culpar y juzgar, pero yo también fui una víctima de un ser despreciable que dijo ser mi amigo.</p>
  </div>

  <div class="section">
    <h2>Instrucciones - Primera Parte</h2>
    <p>Son dos partes y esta es la primera. Cuando la hagas deberías tener tus notas en la versión anterior.</p>
    <p>Ni yo ni nadie tenemos acceso a sus notas, no tiene nada que ver con el código de programación. Sus notas siempre están en sus dispositivos móviles o en sus cuentas de Google Drive. No puedes desinstalar la aplicación hasta que ya tengas tus notas. Si la desinstalaste antes, este proceso ya no funciona.</p>

    <h3>Pasos:</h3>
    <ol>
      <li>Debes ingresar al enlace de prueba.</li>
      <li>Luego darle en convertirte en tester.</li>
      <li>Clic en el primer download que ves.</li>
      <li>Clic en actualizar, debe decir actualizar; si no, algo hiciste mal.</li>
    </ol>

    <p><a href="https://play.google.com/apps/testing/jikansoftware.com.blocdenotas" class="btn" target="_blank">Ir al enlace de prueba</a></p>

    <button class="btn" onclick="document.getElementById('video-container').style.display='block'">Ver Video Explicativo</button>
    <div id="video-container">
      <iframe src="https://www.youtube.com/embed/VIDEO_ID" allowfullscreen></iframe>
    </div>
  </div>

  <div class="section">
    <h2>Segunda Parte</h2>
    <p>Después de recuperar tus notas, por favor haz copias de seguridad para evitar posibles errores. Debes usar el formulario que he creado para eso.</p>
    <p>Después de guardar tus notas, ve a la aplicación en Play Store y deja de ser tester para instalar la versión nueva, ya que esta es temporal. Recuerda: haz esto solo después de haber hecho copia de seguridad.</p>
    <p>La opción más recomendada es usar el formulario de respaldo. Puede ser lento, pero es la más segura. Esta versión antigua es temporal y hay plazo hasta finales de septiembre. Yo estaré pendiente para responder máximo en uno o dos días.</p>
    <p>Me alegro mucho por los usuarios que ya recuperaron sus notas 🙏 Bendiciones. Y recuerda calificarme bien en la versión de prueba y en la versión nueva, gracias.</p>
  </div>

  <div class="section">
    <h2>Generar respaldo blocdenotas_backup.db</h2>
    
    <div id="contenedorNotas"></div>

    <button onclick="agregarNota()">+ Agregar otra nota</button>
    <button onclick="generarRespaldo()">📥 Descargar respaldo_blocdenotas.db</button>

    <p style="text-align:center; font-size:18px; margin-top:30px;">
      📢 <strong>Importante:</strong> Si en la versión de tu aplicación actual no has podido respaldar tus notas, es fundamental que utilices este formulario cuanto antes para guardarlas en un archivo.
      <br><br>
      Una vez descargado el respaldo en tu teléfono 📱, podrás actualizar a la nueva versión de la app desde nuestro enlace especial.
      <br><br>
      👉 <a href="https://play.google.com/apps/testing/jikansoftware.com.blocdenotas" target="_blank" style="font-weight:bold;">Actualizar a la nueva versión desde Google Play</a>
      <br><br>
      📌 Por favor, realiza este proceso antes de actualizar, para que no pierdas ninguna nota importante.
    </p>
  </div>

<script src="https://sql.js.org/dist/sql-wasm.js"></script>
<script>
let contadorNotas = 0;
const LIMITE_NOTAS = 500;

function agregarNota() {
  if (contadorNotas >= LIMITE_NOTAS) {
    alert("Has alcanzado el límite de 500 notas.");
    return;
  }

  contadorNotas++;
  const div = document.createElement('div');
  div.className = 'nota';
  div.innerHTML = `
    <h3>Nota ${contadorNotas}</h3>
    <input type="text" placeholder="Título de la nota" id="titulo${contadorNotas}">
    <textarea placeholder="Contenido de la nota" rows="4" id="contenido${contadorNotas}"></textarea>
  `;
  document.getElementById('contenedorNotas').appendChild(div);
}

async function generarRespaldo() {
  const SQL = await initSqlJs({ locateFile: file => `https://sql.js.org/dist/${file}` });
  const db = new SQL.Database();
  db.run("CREATE TABLE notes (title TEXT, body TEXT, updated_at INTEGER);");

  const now = Date.now();
  let notasInsertadas = 0;

  for (let i = 1; i <= contadorNotas; i++) {
    const tituloInput = document.getElementById(`titulo${i}`);
    const contenidoInput = document.getElementById(`contenido${i}`);

    if (!contenidoInput || !contenidoInput.value.trim()) continue;

    let titulo = "Sin título";
    if (tituloInput && tituloInput.value.trim()) {
      titulo = tituloInput.value.trim();
    }

    const contenido = contenidoInput.value.trim();

    db.run("INSERT INTO notes (title, body, updated_at) VALUES (?, ?, ?);", [titulo, contenido, now + i]);
    notasInsertadas++;
  }

  if (notasInsertadas === 0) {
    alert("Debes ingresar al menos una nota con contenido.");
    return;
  }

  const binaryArray = db.export();
  const blob = new Blob([binaryArray], { type: 'application/octet-stream' });
  const enlace = document.createElement('a');
  enlace.href = URL.createObjectURL(blob);
  enlace.download = 'respaldo_blocdenotas.db';
  enlace.click();
}

agregarNota();
</script>

</body>
</html>


